using FreeLayout.App_Code;
using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace FreeLayout.QCC
{
    public partial class LoginQCC : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                Session["username"] = null;
                Session["password"] = null;
            }
        }

        protected void BtnLoginClick(object sender, EventArgs e)
        {
            string username = Request.Form["username"];
            string password = Request.Form["password"];
            object[] obj = new object[] { username, password };
            DataTable dt = new DataTable();
            dt = DataConn.StoreFillDS("pro_user_login", CommandType.StoredProcedure, obj);
            string User = null;            
            string Pass = null;
            //string Role = null;
            if (dt.Rows[0][0].ToString() != "0")
            {
                User = dt.Rows[0]["User_Name"].ToString();
                Pass = dt.Rows[0]["User_Pass"].ToString();
                //Role = dt.Rows[0]["ROLE"].ToString();

                Session["username"] = User;
                Session["password"] = Pass;
                //Session["role"] = Role;

                //Response.Redirect("~/Default.aspx");
                Response.Redirect("/QCC/DailyMaterial.aspx");
            }
            else
            {
                Page.ClientScript.RegisterStartupScript(Page.GetType(), "Message", " toastr.warning('Sai thông tin đăng nhập hoặc mật khẩu','Lỗi');", true);

            }            
        }



    }
}